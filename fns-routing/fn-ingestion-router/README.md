
# Router Function for the DEX Pipeline

This README describes settings on dev environment and it is subject to change as the FN implementation continue to evolve.  

	
## Details:
The FN listens for messages on "dev-routing-file-dropped" hub,  generated by BlobCreated event on the data exchange storage account.

The configurations for the destination routes is retrieved from cosmosDB.  
The retrieval query is based on destination_id and event properties from the metadata of the blbb properties.


## dex-routing cosmos db
## routing-configs container:
``` json
{
    "destinationId": "dex-hl7",
    "event": "hl7ingress",
    "destinationIdEvent": "dex-hl7-hl7ingress",
    "routes": [
        {
            "destinationStorageAccount": "...",
            "destinationContainer": "...",
            "destinationFolder": "..."
        },
        {
            "destinationStorageAccount": "...",
            "destinationContainer": "...",
            "destinationFolder": "..."
        }
    ],
    "id": "aa443941-a4b1-44d9-95d8-c1f7911c5c9c",
    "_rid": "OL0QAI3HJ7YBAAAAAAAAAA==",
    "_self": "dbs/OL0QAA==/colls/OL0QAI3HJ7Y=/docs/OL0QAI3HJ7YBAAAAAAAAAA==/",
    "_etag": "\"5a007d27-0000-0100-0000-654100bd0000\"",
    "_attachments": "attachments/",
    "_ts": 1698758845
}```
